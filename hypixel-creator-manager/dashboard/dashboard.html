<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Creator Manager | Hypixel</title>
  <link rel="stylesheet" href="dashboard.css">
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
</head>
<body>
  <div class="app">
    <!-- Sidebar Navigation -->
    <aside class="sidebar">
      <div class="sidebar-header">
        <div class="logo-icon">H</div>
        <div class="logo-text">
          <h1>HYPIXEL</h1>
          <span class="badge">Creator Manager</span>
        </div>
      </div>
      
      <nav class="sidebar-nav">
        <a href="#" class="nav-item active" data-page="overview">
          <span class="nav-icon">üìä</span>
          <span>Dashboard</span>
        </a>
        <a href="#" class="nav-item" data-page="creators">
          <span class="nav-icon">üë•</span>
          <span>Creators</span>
        </a>
        <a href="#" class="nav-item" data-page="review">
          <span class="nav-icon">‚úì</span>
          <span>Review Queue</span>
          <span class="nav-badge" id="reviewBadge" style="display:none">0</span>
        </a>
        <a href="#" class="nav-item" data-page="warnings">
          <span class="nav-icon">‚ö†</span>
          <span>Warnings</span>
          <span class="nav-badge" id="warningBadge" style="display:none">0</span>
        </a>
        <a href="#" class="nav-item" data-page="settings">
          <span class="nav-icon">‚öô</span>
          <span>Settings</span>
        </a>
      </nav>
      
      <div class="sidebar-footer">
        <a href="#" class="nav-item" id="exportLink">
          <span class="nav-icon">‚Üì</span>
          <span>Export CSV</span>
        </a>
      </div>
    </aside>

    <!-- Main Content Area -->
    <main class="main-content">
      <header class="main-header">
        <div class="header-left">
          <h2 id="pageTitle">Dashboard</h2>
          <p class="header-subtitle" id="pageSubtitle">Overview of all creator statistics</p>
        </div>
        <div class="header-right">
          <div class="search-box" id="globalSearch" style="display:none">
            <span class="search-icon">üîç</span>
            <input type="text" id="searchInput" placeholder="Search creators...">
          </div>
          <div class="data-indicator">
            <span class="status-dot" id="dataStatusDot"></span>
            <span id="dataStatusText">No data loaded</span>
          </div>
        </div>
      </header>

      <!-- Overview Page -->
      <section class="page active" id="page-overview">
        <div class="upload-section" id="uploadSection">
          <div class="upload-card">
            <div class="upload-icon">üìÅ</div>
            <h3>Import Creator Data</h3>
            <p>Upload your creator spreadsheet to get started with the dashboard.</p>
            
            <div class="upload-area" id="uploadArea">
              <span class="upload-cloud">‚òÅ</span>
              <div class="upload-content">
                <p><strong>Drop CSV file here</strong> or click to browse</p>
                <p class="upload-hint">Supports .csv exports from Google Sheets</p>
              </div>
            </div>
            <input type="file" id="fileInput" accept=".csv" hidden>
            
            <div class="upload-instructions">
              <h4>How to export from Google Sheets</h4>
              <ol>
                <li>Open your spreadsheet in Google Sheets</li>
                <li>Go to <strong>File ‚Üí Download ‚Üí Comma Separated Values (.csv)</strong></li>
                <li>Upload the downloaded file here</li>
              </ol>
            </div>
            
            <div class="upload-divider">or</div>
            
            <button class="btn btn-secondary btn-full" id="btnAddCreatorEmpty">
              Start Fresh
            </button>
          </div>
        </div>

        <div id="statsSection" style="display: none;">
          <div class="last-updated" id="lastUpdated">
            <span>Last imported: <strong id="lastUpdateDate">Never</strong></span>
            <span class="last-updated-divider">|</span>
            <span>Names checked: <strong id="lastNameCheckDate">Never</strong></span>
            <div class="last-updated-actions">
              <button class="btn btn-outline btn-small" id="btnRefreshNames">‚Üª Refresh Names</button>
              <button class="btn btn-outline btn-small" id="btnReimport">‚Üë Re-import CSV</button>
            </div>
          </div>
          
          <div class="bulk-actions-bar">
            <h4>Bulk Actions</h4>
            <div class="bulk-actions-buttons">
              <button class="btn btn-primary" id="btnBulkRefreshStats">
                üìä Refresh All Stats
              </button>
              <button class="btn btn-success" id="btnBulkReviewAll">
                ‚úì Review All Creators
              </button>
            </div>
          </div>

          <div class="stats-grid" id="statsGrid">
            <div class="stat-card">
              <div class="stat-icon">üë•</div>
              <div class="stat-info">
                <span class="stat-value" id="statTotal">0</span>
                <span class="stat-label">Total Creators</span>
              </div>
            </div>
            <div class="stat-card stat-success">
              <div class="stat-icon">‚óè</div>
              <div class="stat-info">
                <span class="stat-value" id="statActive">0</span>
                <span class="stat-label">Active</span>
              </div>
            </div>
            <div class="stat-card stat-warning">
              <div class="stat-icon">‚óè</div>
              <div class="stat-info">
                <span class="stat-value" id="statSemiInactive">0</span>
                <span class="stat-label">Semi-Inactive</span>
              </div>
            </div>
            <div class="stat-card stat-danger">
              <div class="stat-icon">‚óè</div>
              <div class="stat-info">
                <span class="stat-value" id="statInactive">0</span>
                <span class="stat-label">Inactive</span>
              </div>
            </div>
          </div>
          
          <div class="stats-grid stats-grid-secondary">
            <div class="stat-card stat-review">
              <div class="stat-icon">üìã</div>
              <div class="stat-info">
                <span class="stat-value" id="statReview">0</span>
                <span class="stat-label">Pending Review</span>
              </div>
            </div>
            <div class="stat-card stat-alert">
              <div class="stat-icon">‚ö†</div>
              <div class="stat-info">
                <span class="stat-value" id="statWarnings">0</span>
                <span class="stat-label">Have Warnings</span>
              </div>
            </div>
          </div>

          <div class="charts-row">
            <div class="chart-card">
              <h3>Creators by Rank</h3>
              <div class="chart-bars" id="chartRanks">
                <div class="empty-state">
                  <span class="empty-icon">üìä</span>
                  <p>No data available</p>
                </div>
              </div>
            </div>
            <div class="chart-card">
              <h3>Content Types</h3>
              <div class="chart-bars" id="chartContent">
                <div class="empty-state">
                  <span class="empty-icon">üìä</span>
                  <p>No data available</p>
                </div>
              </div>
            </div>
          </div>
          
          <div class="activity-section">
            <h3>Creators Needing Attention</h3>
            <div class="activity-list" id="activityList">
              <div class="empty-state">
                <span class="empty-icon">‚úì</span>
                <p>All creators are up to date</p>
              </div>
            </div>
          </div>
        </div>
      </section>

      <!-- Creators Page -->
      <section class="page" id="page-creators">
        <div class="page-actions">
          <button class="btn btn-primary" id="btnAddCreator">
            + Add Creator
          </button>
        </div>
        
        <div class="table-container">
          <table class="data-table" id="creatorsTable">
            <thead>
              <tr>
                <th style="width:50px"></th>
                <th>Creator</th>
                <th>Platform</th>
                <th>Subscribers</th>
                <th>Last Upload</th>
                <th>Status</th>
                <th>Rank</th>
                <th style="width:100px">Actions</th>
              </tr>
            </thead>
            <tbody id="creatorsTableBody">
              <tr>
                <td colspan="8" class="empty-cell">No creators found. Import a CSV or add creators manually.</td>
              </tr>
            </tbody>
          </table>
        </div>
        <div class="pagination-container" id="paginationContainer"></div>
      </section>

      <!-- Review Queue Page -->
      <section class="page" id="page-review">
        <div class="page-actions">
          <button class="btn btn-primary" id="btnBulkReview" disabled>
            ‚úì Mark Selected as Reviewed
          </button>
        </div>
        
        <div class="review-list" id="reviewList">
          <div class="empty-state">
            <span class="empty-icon">‚úì</span>
            <p>No creators pending review</p>
          </div>
        </div>
      </section>

      <!-- Warnings Page -->
      <section class="page" id="page-warnings">
        <div class="warnings-list" id="warningsList">
          <div class="empty-state">
            <span class="empty-icon">‚úì</span>
            <p>No creators with warnings</p>
          </div>
        </div>
      </section>

      <!-- Settings Page -->
      <section class="page" id="page-settings">
        <div class="settings-section">
          <h3>‚öô General Settings</h3>
          <div class="setting-group">
            <label for="settingReviewerName">Default Reviewer Name</label>
            <input type="text" id="settingReviewerName" placeholder="Enter your name">
          </div>
        </div>

        <div class="settings-section">
          <h3>üì∫ YouTube Data API</h3>
          <p class="setting-help">
            Enable automatic subscriber counts and channel stats. 
            <a href="https://console.cloud.google.com/apis/credentials" target="_blank">Get an API key ‚Üí</a>
          </p>
          <div class="setting-group">
            <label for="settingYoutubeApiKey">API Key</label>
            <div class="api-key-input">
              <input type="password" id="settingYoutubeApiKey" placeholder="Enter your YouTube API key">
              <button class="btn btn-secondary" id="btnSaveYoutubeKey">Save</button>
            </div>
            <div class="api-status-badge" id="youtubeApiStatus">Not configured</div>
          </div>
          
          <div class="info-box">
            <h4>How to get a YouTube API Key</h4>
            <ol>
              <li>Go to <a href="https://console.cloud.google.com/" target="_blank">Google Cloud Console</a></li>
              <li>Create a new project or select an existing one</li>
              <li>Enable the "YouTube Data API v3" from the API Library</li>
              <li>Go to Credentials and create an API Key</li>
              <li>Copy and paste the key above</li>
            </ol>
          </div>
        </div>

        <div class="settings-section">
          <h3>üíú Twitch API</h3>
          <p class="setting-help">
            Enable Twitch channel stats.
            <a href="https://dev.twitch.tv/console/apps" target="_blank">Get credentials ‚Üí</a>
          </p>
          <div class="setting-group">
            <label for="settingTwitchClientId">Client ID</label>
            <input type="text" id="settingTwitchClientId" placeholder="Your Twitch Client ID">
          </div>
          <div class="setting-group">
            <label for="settingTwitchClientSecret">Client Secret</label>
            <div class="api-key-input">
              <input type="password" id="settingTwitchClientSecret" placeholder="Your Twitch Client Secret">
              <button class="btn btn-secondary" id="btnSaveTwitchKey">Save</button>
            </div>
            <div class="api-status-badge" id="twitchApiStatus">Not configured</div>
          </div>
        </div>
        
        <div class="settings-section">
          <h3>üìÅ Data Management</h3>
          <div class="setting-group">
            <label>Export Creator Data</label>
            <p class="setting-help">Download all creator data as a CSV file for backup or to import into Google Sheets.</p>
            <button class="btn btn-secondary" id="btnExportCsv">‚Üì Export to CSV</button>
          </div>
          <div class="setting-group">
            <label>Clear All Data</label>
            <p class="setting-help">Remove all locally stored creator data. This cannot be undone.</p>
            <button class="btn btn-danger" id="btnClearData">Clear Data</button>
          </div>
        </div>
      </section>
    </main>
  </div>

  <!-- Add Creator Modal -->
  <div class="modal" id="addCreatorModal">
    <div class="modal-backdrop" id="addCreatorBackdrop"></div>
    <div class="modal-content modal-large">
      <div class="modal-header">
        <h3>Add New Creator</h3>
        <button class="modal-close" id="addCreatorClose">√ó</button>
      </div>
      <div class="modal-body">
        <form class="add-creator-form" id="addCreatorForm">
          <div class="form-section">
            <h4>Channel Information <span class="section-hint" id="channelAutoFillHint"></span></h4>
            <div class="form-group full-width">
              <label for="newCreatorChannel">Main Channel URL *</label>
              <div class="input-with-button">
                <input type="url" id="newCreatorChannel" required placeholder="https://youtube.com/... or twitch.tv/...">
                <button type="button" class="btn btn-secondary btn-small" id="btnFetchChannelStats">Fetch Stats</button>
              </div>
              <span class="field-hint" id="channelHint">Enter YouTube or Twitch URL</span>
            </div>
            <div class="form-grid">
              <div class="form-group">
                <label for="newCreatorSubscribers">Subscribers</label>
                <input type="text" id="newCreatorSubscribers" placeholder="e.g. 1500000">
              </div>
              <div class="form-group">
                <label for="newCreatorLastUpload">Last Upload</label>
                <input type="text" id="newCreatorLastUpload" placeholder="e.g. 3 Months">
              </div>
            </div>
          </div>
          
          <div class="form-section">
            <h4>Creator Details</h4>
            <div class="form-grid">
              <div class="form-group">
                <label for="newCreatorName">Display Name *</label>
                <input type="text" id="newCreatorName" required placeholder="Creator name">
              </div>
              <div class="form-group">
                <label for="newCreatorRank">Rank</label>
                <select id="newCreatorRank">
                  <option value="">Select rank...</option>
                  <option value="YOUTUBER">YOUTUBER</option>
                  <option value="YT">YT</option>
                  <option value="STREAMER">STREAMER</option>
                  <option value="BUILDER">BUILDER</option>
                  <option value="EVENTS">EVENTS</option>
                </select>
              </div>
            </div>
            <div class="form-grid">
              <div class="form-group">
                <label for="newCreatorContentType">Content Type</label>
                <select id="newCreatorContentType">
                  <option value="">Select type...</option>
                  <option value="Gaming">Gaming</option>
                  <option value="Non-Gaming">Non-Gaming</option>
                  <option value="Mixed">Mixed</option>
                </select>
              </div>
              <div class="form-group">
                <label for="newCreatorLocale">Locale</label>
                <input type="text" id="newCreatorLocale" placeholder="e.g. English">
              </div>
            </div>
          </div>
          
          <div class="form-section">
            <h4>Minecraft Account</h4>
            <div class="form-grid">
              <div class="form-group">
                <label for="newCreatorIGN">Minecraft IGN</label>
                <div class="input-with-button">
                  <input type="text" id="newCreatorIGN" placeholder="Minecraft username">
                  <button type="button" class="btn btn-secondary btn-small" id="btnLookupUUID">Lookup</button>
                </div>
              </div>
              <div class="form-group">
                <label for="newCreatorUUID">UUID</label>
                <input type="text" id="newCreatorUUID" placeholder="Auto-filled from lookup" readonly>
                <span class="field-hint" id="uuidHint">Enter IGN and click Lookup</span>
              </div>
            </div>
          </div>
          
          <div class="form-section">
            <h4>Contact & Notes</h4>
            <div class="form-group full-width">
              <label for="newCreatorEmail">Contact Email</label>
              <input type="email" id="newCreatorEmail" placeholder="creator@email.com">
            </div>
            <div class="form-group full-width">
              <label for="newCreatorNotes">Notes</label>
              <textarea id="newCreatorNotes" placeholder="Any additional notes..."></textarea>
            </div>
          </div>
        </form>
      </div>
      <div class="modal-footer">
        <button class="btn btn-secondary" id="addCreatorCancel">Cancel</button>
        <button class="btn btn-primary" id="addCreatorSubmit">Add Creator</button>
      </div>
    </div>
  </div>
  
  <!-- Name Changes Modal -->
  <div class="modal" id="nameChangesModal">
    <div class="modal-backdrop" id="nameChangesBackdrop"></div>
    <div class="modal-content">
      <div class="modal-header">
        <h3>Name Changes Detected</h3>
        <button class="modal-close" id="nameChangesClose">√ó</button>
      </div>
      <div class="modal-body" id="nameChangesBody">
        <!-- Content populated dynamically -->
      </div>
      <div class="modal-footer">
        <button class="btn btn-primary" id="nameChangesOk">Got It</button>
      </div>
    </div>
  </div>
  
  <!-- Bulk Progress Modal -->
  <div class="modal" id="bulkProgressModal">
    <div class="modal-backdrop" id="bulkProgressBackdrop"></div>
    <div class="modal-content">
      <div class="modal-header">
        <h3 id="bulkProgressTitle">Processing...</h3>
      </div>
      <div class="modal-body">
        <div class="bulk-progress-container">
          <div class="bulk-progress-bar">
            <div class="bulk-progress-fill" id="bulkProgressFill" style="width: 0%"></div>
          </div>
          <div class="bulk-progress-text" id="bulkProgressText">0 / 0</div>
          <div class="bulk-progress-status" id="bulkProgressStatus">Starting...</div>
        </div>
        <div class="bulk-progress-log" id="bulkProgressLog"></div>
      </div>
      <div class="modal-footer" id="bulkProgressFooter" style="display: none;">
        <button class="btn btn-primary" id="bulkProgressClose">Close</button>
      </div>
    </div>
  </div>

  <script src="../lib/csv-manager.js"></script>
  <script src="dashboard.js"></script>
</body>
</html>
